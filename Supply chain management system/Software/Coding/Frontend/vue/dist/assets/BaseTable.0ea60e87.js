import{a as Q}from"./vue-router.8af1d4ba.js";import{_ as W,a as X}from"./Pagination.abd1a0e9.js";import{_ as Y}from"./index.467aec51.js";import{t as Z,K as ee,P as ae,w as L,J as te}from"./@element-plus.c3edeb41.js";import{E as i,a as A}from"./element-plus.45a4936c.js";import{a as le,r as oe,a7 as ne,w as se,ah as ie,M as _,$ as de,z as D,G as ce,U as o,u as t,H as k,O as s,I as N,P as re,A as M,S as f}from"./@vue.2fe925ce.js";const x=b=>{let v=b.target;(v.nodeName=="I"||v.nodeName=="SPAN")&&(v=b.target.parentNode),v.blur()};const ue={class:"container"},pe={class:"handle-box"},ge=f("\u641C\u7D22"),fe=f("\u6E05\u9664 "),he=f(" \u6DFB \u52A0"),_e=f(" \u5220 \u9664"),me=f(" \u7F16\u8F91 "),ve=f("\u5220\u9664 "),be={class:"dialog-footer"},we=f("\u53D6 \u6D88"),xe=f("\u6DFB \u52A0"),Se=f("\u66F4 \u65B0"),$e={props:{page:Object,query:Object,data:Object,formData:Object,formRules:Object,getData:Function,apis:Object},emits:["emitIsDisabled","emitIsShowSearched"],setup(b,{expose:v,emit:S}){const p=b,w=le(),e=oe({searched:[],isShowSearched:!1,selectedList:[],showDialog:!1,addOrUpdate:!0,pageTotal:0,idx:"-1",reIndex:-1}),{page:d,query:n,data:h,formData:u,formRules:O}=ne(p),q=Q();se(()=>q.path,(l,a)=>{m()}),ie(()=>{n.value.id.length==0&&m(),e.pageTotal=h.value.length||n.value.pageSize,S("emitIsShowSearched",e.isShowSearched)});function C(l){x(l),i({message:"\u641C\u7D22\u4E2D...",grouping:!0,type:"success",duration:1e3}),p.apis.read_datas(n.value.id).then(a=>{a.code==200?(e.isShowSearched=!0,e.searched.splice(0,1,a.data),console.log("\u88AB\u641C\u7D22\u7684\u6570\u636E--",a.data)):i.warning("\u7F16\u53F7\u4E0D\u5B58\u5728")}).catch(()=>{i.error("\u641C\u7D22\u6570\u636E\u5931\u8D25!")})}function j(l){x(l),m()}function I(l){l.length==0&&(e.selectedList=[]),l.forEach((a,c)=>{e.selectedList.splice(c,1,{index:c,id:a.id})})}function E(l){x(l),A.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F","\u63D0\u793A",{confirmButtonText:"\u5220\u9664",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{e.selectedList.map(a=>{p.apis.delete_data(a.id).then(c=>{c.code===200?(i.success(`\u5220\u9664\u7F16\u53F7\u4E3A ${a.id} \u7684\u6570\u636E\u6210\u529F\uFF01`),h.value.splice(a.index,1),m(!0)):i.warning(`\u5220\u9664\u7F16\u53F7\u4E3A ${a.id} \u7684\u6570\u636E\u5931\u8D25\uFF01`)}).catch(()=>{i.error("\u5220\u9664\u6570\u636E\u5931\u8D25\uFF01")})})}).catch(()=>{})}function B(l){x(l),Object.keys(u.value).forEach(a=>{u.value[a]=""}),d.value.pageName=="\u9009\u8BFE"&&u.value.grade===""&&(u.value.grade=0),e.showDialog=e.addOrUpdate=!0,S("emitIsDisabled",!1)}function V(){e.showDialog=!1,e.addOrUpdate=!0,w.value.validate(l=>{console.log("formData.value",u.value),l?p.apis.create_data(u.value).then(a=>{a.code==200?(i.success(`\u6210\u529F\u6DFB\u52A0\u7F16\u53F7\u4E3A ${a.data.id} \u7684${d.value.pageName}\u4FE1\u606F\uFF01`),h.value.push(a.data),m(!0)):i.warning(`${d.value.pageName}\u4FE1\u606F\u586B\u5199\u6709\u8BEF\uFF0C\u6DFB\u52A0\u5931\u8D25\uFF01`)}).catch(()=>{i.error(`\u6DFB\u52A0${d.value.pageName}\u4FE1\u606F\u5931\u8D25\uFF01`)}):i.warning(`${d.value.pageName}\u4FE1\u606F\u4E0D\u7B26\u5408\u6821\u9A8C\u89C4\u5219\uFF0C\u6DFB\u52A0\u5931\u8D25\uFF01`),w.value.resetFields()})}function P(l,a){Object.keys(u.value).forEach(c=>{u.value[c]=a[c]}),e.showDialog=!0,e.addOrUpdate=!1,e.idx=a.id,e.reIndex=l,S("emitIsDisabled",!0)}function T(){e.showDialog=e.addOrUpdate=!1,w.value.validate(l=>{l?p.apis.update_data(e.idx,u.value).then(a=>{i.success(`\u4FEE\u6539${d.value.pageName}ID\u4E3A ${e.idx} \u6210\u529F\uFF01`),Object.keys(a.data).forEach(c=>{h.value[e.reIndex][c]=a.data[c]}),n.value.id.length!=0&&(e.searched[0]=u.value,console.log("saveEdit--",e.searched[0])),p.getData()}).catch(()=>{i.error(`\u4FEE\u6539${d.value.pageName}\u4FE1\u606F\u5931\u8D25\uFF01`)}):i.warning(`\u586B\u5199${d.value.pageName}\u4E0D\u7B26\u5408\u6821\u9A8C\u89C4\u5219\uFF0C\u4FEE\u6539\u5931\u8D25\uFF01`)})}function U(l,a){A.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F","\u63D0\u793A",{confirmButtonText:"\u5220\u9664",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{p.apis.delete_data(a.id).then(c=>{c.code===200?(i.success(`\u5220\u9664\u7F16\u53F7\u4E3A ${a.id} \u7684${d.value.pageName}\u4FE1\u606F\u6210\u529F\uFF01`),h.value.splice(l,1),m(!0)):i.warning(`\u5220\u9664\u7F16\u53F7\u4E3A ${a.id} \u7684${d.value.pageName}\u4FE1\u606F\u5931\u8D25\uFF01`)}).catch(()=>{i.error(`\u5220\u9664${d.value.pageName}\u4FE1\u606F\u5931\u8D25\uFF01`)})}).catch(()=>{})}function R(l){n.value.currentPage=l,p.getData()}function m(l=!1){n.value.id="",e.isShowSearched=!1,l&&p.getData()}return v({state:e,page:d,query:n,data:h,formData:u,formRules:O,handleSearch:C,handleRemove:j,handleSelectionChange:I,handleSelectedDelete:E,handleAdd:B,saveAdd:V,handleEdit:P,saveEdit:T,handleDelete:U,pageIndex:R,removeSearch:m}),(l,a)=>{const c=_("el-input"),g=_("el-button"),z=_("el-col"),F=_("el-row"),$=_("el-table-column"),G=_("el-table"),H=_("el-form"),J=_("el-dialog"),K=de("loading");return D(),ce("div",null,[o(W,{"icon-name":t(d).iconName,"page-name":t(d).pageName},null,8,["icon-name","page-name"]),k("div",ue,[k("div",pe,[o(F,null,{default:s(()=>[o(z,{span:16},{default:s(()=>[o(c,{modelValue:t(n).id,"onUpdate:modelValue":a[0]||(a[0]=r=>t(n).id=r),maxlength:"11",placeholder:"\u7F16\u53F7",class:"grid-content handle-input mr10"},null,8,["modelValue"]),N(l.$slots,"filter",{},void 0,!0),o(g,{type:"primary",icon:t(Z),disabled:!/(^[1-9]\d*$)/.test(t(n).id),onClick:C},{default:s(()=>[ge]),_:1},8,["icon","disabled"]),o(g,{type:"primary",icon:t(ee),disabled:t(n).id.length==0,onClick:j},{default:s(()=>[fe]),_:1},8,["icon","disabled"])]),_:3}),o(z,{span:8},{default:s(()=>[o(g,{type:"primary",icon:t(ae),class:"grid-content float-right",onClick:B},{default:s(()=>[he]),_:1},8,["icon"]),o(g,{type:"danger",icon:t(L),class:"grid-content float-right mr10",disabled:t(e).selectedList.length==0,onClick:E},{default:s(()=>[_e]),_:1},8,["icon","disabled"])]),_:1})]),_:3})]),re(o(G,{data:t(e).isShowSearched?t(e).searched:t(h).slice((t(n).currentPage-1)*t(n).pageSize,t(n).currentPage*t(n).pageSize),border:"",stripe:"",class:"table","max-height":"578","default-sort":{prop:"id",order:"ascending"},onSelectionChange:I,"element-loading-text":"\u62FC\u547D\u52A0\u8F7D\u4E2D..."},{default:s(()=>[o($,{type:"selection",width:"80",align:"center"}),o($,{label:"\u5E8F\u53F7",type:"index",width:"80",align:"center",fixed:"",index:r=>r+1+(t(n).currentPage-1)*t(n).pageSize},null,8,["index"]),N(l.$slots,"tableColumn",{},void 0,!0),o($,{label:"\u64CD\u4F5C",width:"220",align:"center",fixed:"right"},{default:s(r=>[o(g,{type:"text",icon:t(te),onClick:y=>P(r.$index,r.row)},{default:s(()=>[me]),_:2},1032,["icon","onClick"]),o(g,{type:"text",icon:t(L),class:"red",onClick:y=>U(r.$index,r.row)},{default:s(()=>[ve]),_:2},1032,["icon","onClick"])]),_:1})]),_:3},8,["data"]),[[K,t(h)==""]]),o(X,{"page-size":t(n).pageSize,"page-total":t(e).pageTotal,disabled:t(e).isShowSearched,onPageIndex:R},null,8,["page-size","page-total","disabled"])]),o(J,{title:`${t(e).addOrUpdate?"\u6DFB\u52A0\u4FE1\u606F":"\u7F16\u8F91\u4FE1\u606F"}`,modelValue:t(e).showDialog,"onUpdate:modelValue":a[2]||(a[2]=r=>t(e).showDialog=r),width:"30%"},{footer:s(()=>[k("span",be,[o(g,{onClick:a[1]||(a[1]=r=>t(e).showDialog=!1)},{default:s(()=>[we]),_:1}),t(e).addOrUpdate?(D(),M(g,{key:0,type:"primary",onClick:V},{default:s(()=>[xe]),_:1})):(D(),M(g,{key:1,type:"primary",onClick:T},{default:s(()=>[Se]),_:1}))])]),default:s(()=>[o(H,{"status-icon":"","label-width":"100px",ref:(r,y)=>{y.formRef=r,w.value=r},model:t(u),rules:t(O)},{default:s(()=>[N(l.$slots,"showDialog",{},void 0,!0)]),_:3},8,["model","rules"])]),_:3},8,["title","modelValue"])])}}};var je=Y($e,[["__scopeId","data-v-87ad4120"]]);export{je as B};
